<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Conversation Mode Demo - MindCare</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="static/css/voice-conversation.css">
    <style>
        :root {
            --periwinkle: #809BCE;
            --periwinkle-light: #95B8D1;
            --bot-color: #b8e0d2;
            --user-color: #809bce;
            --chat-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        body {
            background: var(--chat-bg);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .chat-container {
            height: 70vh;
            overflow-y: auto;
            border: none;
            border-radius: 1rem;
            background: var(--chat-bg);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .message {
            margin-bottom: 1.5rem;
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        .message.user {
            text-align: right;
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
        }

        .message.bot {
            text-align: left;
            display: flex;
            align-items: flex-end;
            gap: 12px;
        }

        .bot-avatar {
            width: 45px;
            height: 45px;
            flex-shrink: 0;
            position: relative;
        }

        .bot-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border: 3px solid var(--periwinkle);
            box-shadow: 0 4px 12px rgba(128, 155, 206, 0.3);
        }

        .message-bubble {
            display: inline-block;
            max-width: 75%;
            padding: 1rem 1.25rem;
            border-radius: 1.5rem;
            word-wrap: break-word;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            backdrop-filter: blur(10px);
        }

        .user .message-bubble {
            background: linear-gradient(135deg, var(--user-color) 0%, #6366f1 100%);
            color: white;
            border-bottom-right-radius: 0.5rem;
        }

        .bot .message-bubble {
            background: linear-gradient(135deg, var(--bot-color) 0%, #d1fae5 100%);
            color: #1f2937;
            border-bottom-left-radius: 0.5rem;
            border: 1px solid rgba(184, 224, 210, 0.3);
        }

        .card {
            border: none !important;
            border-radius: 1.5rem !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1) !important;
            overflow: hidden;
        }

        .demo-info {
            background: rgba(255,255,255,0.9);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .feature-list {
            background: rgba(255,255,255,0.8);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="demo-info">
                    <h1 class="h3 mb-3">
                        <i class="fas fa-microphone text-primary me-2"></i>
                        Hands-Free Voice Conversation Mode Demo
                    </h1>
                    <p class="mb-3">
                        <strong>Experience seamless voice interaction with MindCare's AI chatbot!</strong>
                        This demo showcases the continuous hands-free conversation feature.
                    </p>
                    <div class="row">
                        <div class="col-md-6">
                            <h5><i class="fas fa-play-circle text-success me-2"></i>How to Use:</h5>
                            <ol>
                                <li>Click the <strong>"Voice"</strong> button in the chat header</li>
                                <li>Allow microphone permissions when prompted</li>
                                <li>Click the microphone icon in the overlay to start listening</li>
                                <li>Speak naturally - the bot will respond and keep listening automatically</li>
                                <li>Click the ‚ùå button or wait for silence timeout to exit</li>
                            </ol>
                        </div>
                        <div class="col-md-6">
                            <h5><i class="fas fa-star text-warning me-2"></i>Key Features:</h5>
                            <ul>
                                <li><strong>Continuous Listening:</strong> Auto-restarts after each response</li>
                                <li><strong>Hands-Free:</strong> No need to click after the first start</li>
                                <li><strong>Smart Timeout:</strong> Stops after 8-10 seconds of silence</li>
                                <li><strong>Visual Feedback:</strong> Pulsing avatar shows listening/speaking states</li>
                                <li><strong>Multi-language:</strong> Supports English and Hindi (Hinglish)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-12">
                <div class="chat-header rounded-4 p-4 mb-4" style="background: linear-gradient(135deg, var(--periwinkle) 0%, #667eea 100%); color: white; box-shadow: 0 6px 20px rgba(128, 155, 206, 0.3);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-3">
                            <div class="chat-icon-wrapper">
                                <i class="fas fa-robot fa-2x"></i>
                            </div>
                            <div>
                                <h1 class="h3 mb-1">AI Mental Health Assistant</h1>
                                <p class="mb-0 opacity-75 small">Your caring companion for mental wellness</p>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-light btn-sm rounded-pill px-3" onclick="clearChat()">
                                <i class="fas fa-broom me-1"></i> Clear
                            </button>
                            <button class="btn btn-outline-light btn-sm rounded-pill px-3" id="voice-conversation-trigger">
                                <i class="fas fa-microphone me-1"></i> Voice
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body p-0">
                        <div id="chat-messages" class="chat-container p-3">
                            <div class="text-center py-5">
                                <div class="mb-4">
                                    <i class="fas fa-heart fa-3x text-success"></i>
                                </div>
                                <h4 class="text-dark fw-bold mb-3">Hello! I'm here to help üåü</h4>
                                <p class="text-muted lead mb-4">
                                    I'm your AI mental health companion. Try the voice mode by clicking the "Voice" button above!
                                </p>
                                <div class="d-flex flex-wrap gap-2 justify-content-center">
                                    <button class="btn btn-outline-secondary btn-sm rounded-pill" onclick="addDemoMessage('I\'m feeling anxious today', 'user')">
                                        Try: "I'm feeling anxious"
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm rounded-pill" onclick="addDemoMessage('I need someone to talk to', 'user')">
                                        Try: "Need to talk"
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm rounded-pill" onclick="addDemoMessage('How can I manage stress?', 'user')">
                                        Try: "Stress management"
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-input-area p-4" style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-top: 1px solid rgba(128, 155, 206, 0.2);">
                            <form id="chat-form" onsubmit="sendMessage(event)">
                                <div class="input-group shadow-sm">
                                    <input type="text" id="message-input" name="message" 
                                           class="form-control form-control-lg rounded-start-pill border-0" 
                                           style="background: #f8fafc; padding-left: 1.5rem; font-size: 1rem;"
                                           placeholder="Share what's on your mind..." required>
                                    <button type="submit" class="btn btn-lg rounded-end-pill border-0" id="send-btn"
                                            style="background: linear-gradient(135deg, var(--periwinkle) 0%, #667eea 100%); color: white; padding: 0 1.5rem;">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </form>
                            
                            <div class="mt-3 text-center">
                                <small class="text-muted">
                                    <i class="fas fa-microphone me-1"></i>
                                    Click "Voice" button above to start hands-free conversation
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="feature-list">
            <h4><i class="fas fa-cogs text-primary me-2"></i>Technical Implementation</h4>
            <div class="row">
                <div class="col-md-4">
                    <h6><i class="fas fa-code text-info me-2"></i>Frontend Technologies</h6>
                    <ul class="small">
                        <li>Web Speech API (webkitSpeechRecognition)</li>
                        <li>Speech Synthesis API</li>
                        <li>MediaRecorder API (fallback)</li>
                        <li>Bootstrap 5 + Custom CSS</li>
                        <li>Font Awesome Icons</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h6><i class="fas fa-brain text-success me-2"></i>Voice Features</h6>
                    <ul class="small">
                        <li>Continuous speech recognition</li>
                        <li>Automatic restart after responses</li>
                        <li>Silence detection & timeout</li>
                        <li>Real-time transcript display</li>
                        <li>Text-to-speech synthesis</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h6><i class="fas fa-palette text-warning me-2"></i>Design Elements</h6>
                    <ul class="small">
                        <li>Semi-transparent overlay</li>
                        <li>Pulsing avatar animations</li>
                        <li>Gradient backgrounds</li>
                        <li>Smooth transitions</li>
                        <li>Responsive design</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Demo bot responses
        const demoResponses = {
            "I'm feeling anxious today": "I understand that anxiety can be overwhelming. It's completely normal to feel this way sometimes. Let's take a deep breath together. What specifically is making you feel anxious right now?",
            "I need someone to talk to": "I'm here for you, and I'm glad you reached out. Sometimes just talking about what's on your mind can provide relief. What would you like to share with me today?",
            "How can I manage stress?": "Stress management is very important for your wellbeing. Here are some techniques that can help: deep breathing exercises, regular physical activity, mindfulness meditation, and maintaining a healthy sleep schedule. Which of these resonates with you the most?"
        };

        // Simulate chat functionality for demo
        function sendMessage(event) {
            event.preventDefault();
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (message) {
                addDemoMessage(message, 'user');
                input.value = '';
                
                // Simulate bot response after delay
                setTimeout(() => {
                    const response = demoResponses[message] || `Thank you for sharing "${message}" with me. I'm here to listen and support you. How are you feeling right now?`;
                    addDemoMessage(response, 'bot');
                }, 1000 + Math.random() * 1000);
            }
        }

        function addDemoMessage(content, type) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            let messageHTML = '';
            if (type === 'bot') {
                messageHTML = `
                    <div class="bot-avatar">
                        <i class="fas fa-robot text-primary" style="font-size: 24px; line-height: 45px;"></i>
                    </div>
                    <div class="message-bubble">
                        <div class="message-content">${content}</div>
                        <small class="message-time text-muted d-block mt-1">
                            ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </small>
                    </div>
                `;
            } else {
                messageHTML = `
                    <div class="message-bubble">
                        <div class="message-content">${content}</div>
                        <small class="message-time text-muted d-block mt-1">
                            ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </small>
                    </div>
                `;
            }
            
            messageDiv.innerHTML = messageHTML;
            chatMessages.appendChild(messageDiv);
            
            // Clear welcome message if it exists
            const welcomeMessage = chatMessages.querySelector('.text-center.py-5');
            if (welcomeMessage) {
                welcomeMessage.remove();
            }
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function clearChat() {
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.innerHTML = `
                <div class="text-center py-5">
                    <div class="mb-4">
                        <i class="fas fa-heart fa-3x text-success"></i>
                    </div>
                    <h4 class="text-dark fw-bold mb-3">Hello! I'm here to help üåü</h4>
                    <p class="text-muted lead mb-4">
                        I'm your AI mental health companion. Try the voice mode by clicking the "Voice" button above!
                    </p>
                </div>
            `;
        }

        // Auto-focus input
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('message-input').focus();
        });
    </script>

    <script src="static/js/voice-conversation.js"></script>
</body>
</html>